<!DOCTYPE html><html lang="en" class="dark"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/e4af272ccee01ff0-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" as="image" href="/images/noise-injection/result_graph_mini128k.png"/><link rel="preload" as="image" href="/images/noise-injection/PaperGraph.png"/><link rel="stylesheet" href="/_next/static/css/528c5d8995e2c2e4.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-b10e1bf7a5faa37c.js"/><script src="/_next/static/chunks/fd9d1056-ae97a97996823271.js" async=""></script><script src="/_next/static/chunks/117-6a2f96f6d229f3b2.js" async=""></script><script src="/_next/static/chunks/main-app-99cdcbcb62796829.js" async=""></script><script src="/_next/static/chunks/app/blog/noise-injection/page-168470f09d159ccb.js" async=""></script><script src="/_next/static/chunks/972-2ef7f6e850b6bfe8.js" async=""></script><script src="/_next/static/chunks/app/layout-9a64efe068df8acd.js" async=""></script><script src="/_next/static/chunks/878-12d1c1a81e6d2591.js" async=""></script><script src="/_next/static/chunks/app/page-86d8a14aa46b2d9e.js" async=""></script><title>Keshav Shenoy</title><meta name="description" content="A blog about my work and projects"/><link rel="shortcut icon" href="/favicon/icon1.png"/><link rel="icon" href="/favicon/favicon.ico"/><link rel="apple-touch-icon" href="/favicon/apple-icon.png"/><meta name="next-size-adjust"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__className_e8ce0c min-h-screen transition-colors duration-200 
        bg-slate-900 text-gray-100"><div class="max-w-5xl mx-auto px-4 py-8"><header class="mb-8"><nav class="flex items-center justify-between"><a class="text-2xl font-bold nav-link hover:text-emerald-400 transition-colors" href="/">Keshav Shenoy</a></nav></header><main><div class="grid grid-cols-1 lg:grid-cols-[200px_minmax(0,1fr)] gap-8"><article class="prose blog-content
          "><h1 class="text-4xl font-bold mb-8 dark:text-white light-mode:text-gray-900" id="heading-replicating-&quot;noise-injection-reveals-hidden-capabilities-of-sandbagging-language-models&quot;">Replicating &quot;Noise Injection Reveals Hidden Capabilities of Sandbagging Language Models&quot;</h1>
<p class="mb-4 dark:text-gray-300 light-mode:text-gray-700 leading-relaxed">I replicated the evaluation results from the paper <a href="https://arxiv.org/abs/2412.01784" class="!inline-flex !items-center !gap-1 dark:!text-emerald-400 dark:hover:!text-emerald-300 light-mode:!text-emerald-600 light-mode:hover:!text-emerald-700 !transition-colors" target="_blank" rel="noopener noreferrer">&quot;Noise Injection Reveals Hidden Capabilities of Sandbagging Language Models&quot;<span class="text-xs opacity-50 group-hover:opacity-100 transition-opacity">↗</span></a> by Tice et al. (2024). This paper prompted models to sandbag, and then evaluated how the sandbagging behavior changed when the weights were perturbed with noise. It generally showed that adding noise increased performance for sandbagging models, while reducing performance for non-sandbagging models. They also showed that this effect generalized across multiple datasets and also worked for models that were fine-tuned to sandbag in the presence of a password.</p>
<h2 class="text-2xl font-bold mt-8 mb-4 dark:text-white light-mode:text-gray-900 border-l-4 border-emerald-500 pl-3" id="heading-code">Code</h2>
<p class="mb-4 dark:text-gray-300 light-mode:text-gray-700 leading-relaxed">The code for this replication is available on GitHub:</p>
<p class="mb-4 dark:text-gray-300 light-mode:text-gray-700 leading-relaxed"><a href="https://github.com/k-shenoy/noise-injection-sandbagging-repl" class="!inline-flex !items-center !gap-1 dark:!text-emerald-400 dark:hover:!text-emerald-300 light-mode:!text-emerald-600 light-mode:hover:!text-emerald-700 !transition-colors" target="_blank" rel="noopener noreferrer">GitHub Repository: noise-injection-sandbagging-repl<span class="text-xs opacity-50 group-hover:opacity-100 transition-opacity">↗</span></a></p>
<h2 class="text-2xl font-bold mt-8 mb-4 dark:text-white light-mode:text-gray-900 border-l-4 border-emerald-500 pl-3" id="heading-methodological-differences">Methodological Differences</h2>
<p class="mb-4 dark:text-gray-300 light-mode:text-gray-700 leading-relaxed">The implementation differs from the paper in several major ways:</p>
<ol>
<li class="dark:text-gray-300 light-mode:text-gray-700">
<p class="mb-4 dark:text-gray-300 light-mode:text-gray-700 leading-relaxed">I limited myself to a much narrower scope of models and datasets than the paper. I ran the experiment on only Phi-3-mini with the tiny AI2 arc dataset. This was intended to mimic the results they chose to show in Figure 2 in the paper. As such, I also did not test this on any models that sandbagged from finetuning rather than by prompting.</p>
</li>
<li class="dark:text-gray-300 light-mode:text-gray-700">
<p class="mb-4 dark:text-gray-300 light-mode:text-gray-700 leading-relaxed">I skipped creating a XGBoost decision tree model to classify models, since I do not think it would be very robust from my small set of improvement ratios.</p>
</li>
<li class="dark:text-gray-300 light-mode:text-gray-700">
<p class="mb-4 dark:text-gray-300 light-mode:text-gray-700 leading-relaxed">I ran my sweep over σ every 0.0002, while the paper used 0.0001. This was purely to save time and compute. I used the same number of seeds: 5.</p>
</li>
<li class="dark:text-gray-300 light-mode:text-gray-700">
<p class="mb-4 dark:text-gray-300 light-mode:text-gray-700 leading-relaxed">In the paper, the authors do not state which portions of the tiny AI2 arc dataset they used. I used the entire test set (100 samples).</p>
</li>
</ol>
<h2 class="text-2xl font-bold mt-8 mb-4 dark:text-white light-mode:text-gray-900 border-l-4 border-emerald-500 pl-3" id="heading-results">Results</h2>
<table><thead><tr><th>Model Condition</th><th>My Implementation</th><th>Original Paper</th></tr></thead><tbody><tr><td>Standard Improvement Ratio</td><td>1.0125</td><td>1.010</td></tr><tr><td>Sandbagging Improvement Ratio</td><td>3.3333</td><td>1.387</td></tr></tbody></table>
<div class="space-y-8 mb-6"><figure><img src="/images/noise-injection/result_graph_mini128k.png" alt="My replication: Noise Injection Effects on Phi-3-mini-128k-instruct" class="w-full"/><figcaption class="text-center text-sm text-gray-400 mt-2"><p class="mb-4 dark:text-gray-300 light-mode:text-gray-700 leading-relaxed">Figure 1: My replication results - Effect of noise on accuracy for Phi-3-mini in both standard and sandbagging conditions. The graph shows individual seed runs (faint lines) and maximum performance (bold lines).</p></figcaption></figure><figure><img src="/images/noise-injection/PaperGraph.png" alt="Original paper results: Noise Injection Effects on Phi-3-mini" class="w-full"/><figcaption class="text-center text-sm text-gray-400 mt-2"><p class="mb-4 dark:text-gray-300 light-mode:text-gray-700 leading-relaxed">Figure 2: Original paper results - Screenshot directly from the paper</p></figcaption></figure></div>
<h2 class="text-2xl font-bold mt-8 mb-4 dark:text-white light-mode:text-gray-900 border-l-4 border-emerald-500 pl-3" id="heading-discussion">Discussion</h2>
<p class="mb-4 dark:text-gray-300 light-mode:text-gray-700 leading-relaxed">Despite implementation differences, the overall results are mostly consistent with the paper&#x27;s.</p>
<p class="mb-4 dark:text-gray-300 light-mode:text-gray-700 leading-relaxed">The improvement ratio is much larger for sandbagging. This seems to be because the sandbagging model was able to decrease performance significantly more than the paper&#x27;s models, not because the model reaches a different overall performance peak. The prompts and models are the same, so I&#x27;m not sure why the base accuracy is so different. My best guess is that the paper uses a different subset of the AI2 dataset which the sandbagging model performs better on.</p>
<p class="mb-4 dark:text-gray-300 light-mode:text-gray-700 leading-relaxed">My results vary slightly more as noise increases, with larger jumps and falls. This is definitely in part due to the bigger step size for sigma, but the marked difference in smoothness on the graph shows there is likely some other methodological explanation I need to investigate.</p>
<p class="mb-4 dark:text-gray-300 light-mode:text-gray-700 leading-relaxed">This is a really cool way to reveal capabilities that a model was hiding and I&#x27;m interested in if similar methods could be used for other forms of deception. My initial intuition was that this may not scale to capabilities that are more complex than sandbagging, because they may be relatively easier to disrupt with noise. This is also a limitation the authors mention in the paper. As such, I&#x27;m interested in trying this on more difficult evaluations and may attempt to in the future.</p>
<h2 class="text-2xl font-bold mt-8 mb-4 dark:text-white light-mode:text-gray-900 border-l-4 border-emerald-500 pl-3" id="heading-references">References</h2>
<p class="mb-4 dark:text-gray-300 light-mode:text-gray-700 leading-relaxed">Tice, C., Kreer, P. A., Helm-Burger, N., Shahani, P. S., Ryzhenkov, F., Haimes, J., Hofstätter, F., &amp; van der Weij, T. (2024). Noise Injection Reveals Hidden Capabilities of Sandbagging Language Models. <em>arXiv preprint arXiv:2412.01784</em>. https://arxiv.org/abs/2412.01784</p></article></div><button class="fixed top-8 right-8 bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-full shadow-lg transition-all duration-300 transform hover:scale-105 z-50 opacity-0 pointer-events-none" aria-label="Back to top"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"></path></svg></button></main><footer class="mt-8 py-4 text-center dark:text-gray-400 light-mode:text-gray-500">© <!-- -->2025<!-- --> Keshav Shenoy. All rights reserved.</footer></div><script src="/_next/static/chunks/webpack-b10e1bf7a5faa37c.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/media/e4af272ccee01ff0-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n2:HL[\"/_next/static/css/528c5d8995e2c2e4.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"3:I[2846,[],\"\"]\n5:I[8389,[\"206\",\"static/chunks/app/blog/noise-injection/page-168470f09d159ccb.js\"],\"default\"]\n6:I[4707,[],\"\"]\n7:I[6423,[],\"\"]\n8:I[8009,[\"972\",\"static/chunks/972-2ef7f6e850b6bfe8.js\",\"185\",\"static/chunks/app/layout-9a64efe068df8acd.js\"],\"ThemeProvider\"]\n9:I[2972,[\"972\",\"static/chunks/972-2ef7f6e850b6bfe8.js\",\"878\",\"static/chunks/878-12d1c1a81e6d2591.js\",\"931\",\"static/chunks/app/page-86d8a14aa46b2d9e.js\"],\"\"]\nb:I[1060,[],\"\"]\nc:[]\n"])</script><script>self.__next_f.push([1,"0:[\"$\",\"$L3\",null,{\"buildId\":\"CYwiF-4hFBwbN-1-wiCHu\",\"assetPrefix\":\"\",\"urlParts\":[\"\",\"blog\",\"noise-injection\",\"\"],\"initialTree\":[\"\",{\"children\":[\"blog\",{\"children\":[\"noise-injection\",{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"blog\",{\"children\":[\"noise-injection\",{\"children\":[\"__PAGE__\",{},[[\"$L4\",[\"$\",\"$L5\",null,{}],null],null],null]},[null,[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"noise-injection\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L7\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]],null]},[null,[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L7\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]],null]},[[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/528c5d8995e2c2e4.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"dark\",\"children\":[\"$\",\"body\",null,{\"className\":\"__className_e8ce0c min-h-screen transition-colors duration-200 \\n        bg-slate-900 text-gray-100\",\"children\":[\"$\",\"$L8\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"max-w-5xl mx-auto px-4 py-8\",\"children\":[[\"$\",\"header\",null,{\"className\":\"mb-8\",\"children\":[\"$\",\"nav\",null,{\"className\":\"flex items-center justify-between\",\"children\":[\"$\",\"$L9\",null,{\"href\":\"/\",\"className\":\"text-2xl font-bold nav-link hover:text-emerald-400 transition-colors\",\"children\":\"Keshav Shenoy\"}]}]}],[\"$\",\"main\",null,{\"children\":[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L7\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[]}]}],[\"$\",\"footer\",null,{\"className\":\"mt-8 py-4 text-center dark:text-gray-400 light-mode:text-gray-500\",\"children\":[\"© \",2025,\" Keshav Shenoy. All rights reserved.\"]}]]}]}]}]}]],null],null],\"couldBeIntercepted\":false,\"initialHead\":[null,\"$La\"],\"globalErrorComponent\":\"$b\",\"missingSlots\":\"$Wc\"}]\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"Keshav Shenoy\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"A blog about my work and projects\"}],[\"$\",\"link\",\"4\",{\"rel\":\"shortcut icon\",\"href\":\"/favicon/icon1.png\"}],[\"$\",\"link\",\"5\",{\"rel\":\"icon\",\"href\":\"/favicon/favicon.ico\"}],[\"$\",\"link\",\"6\",{\"rel\":\"apple-touch-icon\",\"href\":\"/favicon/apple-icon.png\"}],[\"$\",\"meta\",\"7\",{\"name\":\"next-size-adjust\"}]]\n4:null\n"])</script></body></html>